<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Postgresql | kencho51</title>
<meta name="keywords" content="postgreSQL, SQL, database">
<meta name="description" content="Everything about PostgreSQL database">
<meta name="author" content="Ken Cho">
<link rel="canonical" href="https://gigathing.pages.dev/postgresql/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://gigathing.pages.dev/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://gigathing.pages.dev/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gigathing.pages.dev/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://gigathing.pages.dev/apple-touch-icon.png">
<link rel="mask-icon" href="https://gigathing.pages.dev/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gigathing.pages.dev/postgresql/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://gigathing.pages.dev/postgresql/">
  <meta property="og:site_name" content="kencho51">
  <meta property="og:title" content="Postgresql">
  <meta property="og:description" content="Everything about PostgreSQL database">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2020-06-09T10:25:23+08:00">
    <meta property="article:modified_time" content="2020-06-09T10:25:23+08:00">
    <meta property="article:tag" content="PostgreSQL">
    <meta property="article:tag" content="SQL">
    <meta property="article:tag" content="Database">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Postgresql">
<meta name="twitter:description" content="Everything about PostgreSQL database">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://gigathing.pages.dev/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Postgresql",
      "item": "https://gigathing.pages.dev/postgresql/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Postgresql",
  "name": "Postgresql",
  "description": "Everything about PostgreSQL database",
  "keywords": [
    "postgreSQL", "SQL", "database"
  ],
  "articleBody": "What is PostgreSQL? PostgreSQL is an enterprise-class open source database management system. It supports both SQL for relational and JSON for non-relational queries. PostgreSQL supports advanced data types and advance performance optimization.\nKey features Compatible with various platforms using all major languages and middleware It offers a most sophisticated locking mechanism Support for multi-version concurrency control Compliant with the ANSI SQL standard Full support for client-server network architecture Log-based and trigger-based replication SSL Standby server and high availability Object-oriented and ANSI-SQL2008 compatible Support for JSON allows linking with other data stores like NoSQL which act as a federated hub for polyglot databases MySQL vs PostgreSQL MySQL PostgreSQL The MySQL project has made its source code available under the terms of the GNU License, and other proprietary agreements. PostgreSQL is released under PostgreSQL License. It’s now owned by Oracle Corporation and offers several paid editions. It’s free and open-source software. That means you will never need to pay anything for this service. MySQL is ACID compliant only when using with NDB and InnoDB Cluster Storage engines. PostgreSQL is completely ACID compliant. MySQL performs well in OLAP and OLTP systems where only read speed is important. PostgreSQL performance works best in systems which demand the execution of complex queries. MySQL is reliable and works well with BI (Business Intelligence) applications, which are difficult to read PostgreSQL works well with BI applications. However, it is more suited for Data Warehousing and data analysis applications which need fast read-write speeds. Advantages Can run dynamic websites and web apps. Write-ahead logging makes it a highly fault-tolerant database. Source code is freely available under an open source license. Supports geographic objects so you can use it for location-based services and geographic information systems. Supports geographic objects so it can be used as a geospatial data store for location-based services and geographic information systems. Low maintenance administration for both embedded and enterprise use. Disadvantages Changes made for speed improvement requires more work than MySQL as PostgreSQL focuses on compatibility. Many open source apps support MySQL, but may not support PostgreSQL. On performance metrics, it is slower than MySQL. Download and install Download and install postgrlSQL\nbrew doctor\nbrew update\nbrew install postgresql Download and install Pgcli, for Postgres with auto-completion and syntax highlighting.\nbrew install pgcli The path of psql\nbrew info libpq To include in in zshrc\necho 'export PATH=\"/usr/local/opt/libpq/bin:$PATH\"' \u003e\u003e ~/.zshrc Postgre.app Postgre.app is a full-featured PostgreSQL installation packaged as a standard Mac app.\nConfigure the $PATH for CLI (Optional) sudo mkdir -p /etc/paths.d \u0026\u0026 echo /Applications/Postgres.app/Contents/Versions/latest/bin | sudo tee /etc/paths.d/postgresapp\nChanging the default directory of PostgreSQL (Optional) kencho=# SHOW data_directory;\n/Users/kencho/Library/Application Support/Postgres/var-12\nDatatypes Characters Name Description varchr(n) Allows you to declare variable-length with a limit char(n) Fixed-length, blank padded text User can use this data type to declare a variable with unlimited length Numeric Integers Floating-pointing numbers Binary Binary strings allow storing odds of value zero Non- printable octets Network Address Type cider: IPv4 and IPv6 networks Inet: IPv4 and IPv5 host and networks macaaddr: MAC addresses Text Search Type\nDate/Time PostgreSQL timestamp offers microsecond precision instead of second precision. Date and time input is accepted in various format, including traditional Postgres, ISO 8601. SQL-compatible etc.\nBoolean\nTrue, 1 False, 0 null Geometric\nEnumerated\nEnumerated Data types in PostgreSQL is useful for representing rarely changing information such as country code or branch id. The Enumerated data type is represented in a table with foreign keys to ensure data integrity. Here is the example code:\n#Hair color is fairly static in a demographic database CREATE TYPE hair_color AS ENUM ('brown','black','red','grey','blond') Range\nUUID Universally Unique Identifies (UUID) is a 128-bit quantity, these identifiers are an ideal choice as it offers uniqueness within a single database.\nExample:\nd5f28c97-b962-43be-9cf8-ca1632182e8e\nXML PostgreSQL allows you to store XML data in a data type, but it is nothing more than an extension to a text data type.\nBut the advantage is that it checks that the input XML is well-formed.\nJson\nJson Jsonb CREATE TABLE employee ( id integer NOT NULL, age integer NOT NULL, data jsonb ); Pseudo-types\nPostgreSQL has many special-purpose entries that are called pseudo-types. You can’t use pseudo-type as a column data type. There are used to declare or function’s argument or return type.\nEach of the available pseudo-types is helpful in situations where a function’s behavior docs do not correspond to simply taking or returning a value of a specific SQL data type. Best practice using data types Use “text” data type unless you want to limit the input Never use “char.” Integers use “int.” Use bigint only when you have really big numbers Use “numeric” almost always Use float data type if you have IEEE 754 data source Export/save table or query Check current position\n\\! pwd List folders\n\\! ls Export the Full tables with header\nCOPY albums TO '/Users/dave/Downloads/albums.csv' DELIMITER ',' CSV HEADER; Export the query to CSV with header\n\\copy [Table/Query] to [Relative Path] csv header PostgreSQL backup One-time single database backup pg_dump to back up a single database. It must be run as a user with read permissions to the database you intend to back up. 1.1 Log in as postgre user\nsu - postgres\n1.2 Dump the contents of a database to a file\npg_dump dbname \u003e dbname.bak\n1.3 Restore the database using psql\npsql newdb \u003c dbname.bak\nBackup single database remotely\npg_dump -h 198.51.100.0 -p 5432 dbname \u003e dbname.bak\nBackup all databases\npg_dumponly creates a backup of one database at a time, it does not store information about database roles or other cluster-wide configuration. pg_dumpall can store information about database roles and other cluster-wide configuration.\n3.1 Create backup file pg_dumpall \u003e pg_backup.bak\n3.2 Restore all databases from the backup\npsql -f pg_backup.bak psotgre\nAutomate backup with a cron task (say, backed up at midnight every Sunday) Log is as the postgre user\nsu - postgre Create a directory to store the automatic backups mkdir -p /postgre/backups Edit the crontab to create a cron task crontab -e The cron task as 0 0 * * 0 pg_dump -U postgres dbname \u003e ~/postgres/backups/dbname.bak \u003e /postgres/log/pg_dump.log Database backup formats *.bak: compressed binary format *.sql: plaintext dump *.tar: tarball How to know if the PostgreSQL backup is good? A. Logical backup: The backup is stored in a human-readable format like SQL.\nB. Physical backup: The backup contains binary data.\nbackup the database with logs pg_dumpall \u003e /path/to/dump.sql \u003e postgres/log/pg_dump.log\nThen to verify the databse.bak is in the backup directory\n$ grep '^[\\]connect' /path/to/dump.sql |awk '{print $2}' template1 postgres world Finally, restore the backup and check manually, it is the most secure way to confirm # restore the backup $ psql -f /path/to/dump.sql postgres # access it and check it $ psql postgres=# \\l Handling large databases Some operating systems have maximum file size limits that cause problems when creating large pg_dump output files. Fortunately, pg_dump can write to the standard output, so you can use standard Unix tools to work around this potential problem.\n1.1 Use compressed dump\npg_dump dbname | gzip \u003e filename.gz\n1.2. Reload with\ngunzip -c filename.gz | psql dbname or\ncat filename.gz | gunzip | psql dbname\n2.1 Use splite, split the output into smaller files that are acceptable in size to the underlying file system.\npg_dump dbname | split -b 1m - filename\n2.2 Reload with\ncat filename* | psql dbname\nConnected to gigadb database container Connect to gigadb database container locally\nPGPASSWORD=vagrant psql -h localhost -p 54321 -U gigadb postgres Create database\npostgre=# CREATE DATADASE dbname; Restore dump database\nkencho % pg_restore -h localhost -p 54321 -U gigadb -d production_like --clean --no-owner -v sql/production_like.pgdmp Reference Introduction to PostgreSQL PostgreSQL download 10 Command-line Utilities in PostgreSQL cheatsheet Postgres Guide How to exort PostgreSQL Data to a CSV or Excel File PostgreSQL backup stratgy Cron task How Do I Know if My PostgreSQL Backup is Good? Chapter 24. Backup and Restore Automated Testing of PostgreSQL Backups SQL Tutorial ",
  "wordCount" : "1319",
  "inLanguage": "en",
  "datePublished": "2020-06-09T10:25:23+08:00",
  "dateModified": "2020-06-09T10:25:23+08:00",
  "author":{
    "@type": "Person",
    "name": "Ken Cho"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gigathing.pages.dev/postgresql/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "kencho51",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gigathing.pages.dev/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gigathing.pages.dev/" accesskey="h" title="kencho51 (Alt + H)">kencho51</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gigathing.pages.dev/page/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://gigathing.pages.dev/post" title="Tech">
                    <span>Tech</span>
                </a>
            </li>
            <li>
                <a href="https://gigathing.pages.dev/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://gigathing.pages.dev/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gigathing.pages.dev/">Home</a>&nbsp;»&nbsp;<a href="https://gigathing.pages.dev/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Postgresql
    </h1>
    <div class="post-description">
      Everything about PostgreSQL database
    </div>
    <div class="post-meta"><span title='2020-06-09 10:25:23 +0800 HKT'>June 9, 2020</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Ken Cho

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#what-is-postgresql" aria-label="What is PostgreSQL?">What is PostgreSQL?</a></li>
                <li>
                    <a href="#key-features" aria-label="Key features">Key features</a></li>
                <li>
                    <a href="#mysql-vs-postgresql" aria-label="MySQL vs PostgreSQL">MySQL vs PostgreSQL</a></li>
                <li>
                    <a href="#advantages" aria-label="Advantages">Advantages</a></li>
                <li>
                    <a href="#disadvantages" aria-label="Disadvantages">Disadvantages</a></li>
                <li>
                    <a href="#download-and-install" aria-label="Download and install">Download and install</a></li>
                <li>
                    <a href="#postgreapp" aria-label="Postgre.app">Postgre.app</a></li>
                <li>
                    <a href="#configure-the-path-for-cli-optional" aria-label="Configure the $PATH for CLI (Optional)">Configure the $PATH for CLI (Optional)</a></li>
                <li>
                    <a href="#changing-the-default-directory-of-postgresql-optional" aria-label="Changing the default directory of PostgreSQL (Optional)">Changing the default directory of PostgreSQL (Optional)</a></li>
                <li>
                    <a href="#datatypes" aria-label="Datatypes">Datatypes</a></li>
                <li>
                    <a href="#best-practice-using-data-types" aria-label="Best practice using data types">Best practice using data types</a></li>
                <li>
                    <a href="#exportsave-table-or-query" aria-label="Export/save table or query">Export/save table or query</a></li>
                <li>
                    <a href="#postgresql-backup" aria-label="PostgreSQL backup">PostgreSQL backup</a></li>
                <li>
                    <a href="#automate-backup-with-a-cron-task-say--backed-up-at-midnight-every-sunday" aria-label="Automate backup with a cron task (say,  backed up at midnight every Sunday)">Automate backup with a cron task (say,  backed up at midnight every Sunday)</a></li>
                <li>
                    <a href="#database-backup-formats" aria-label="Database backup formats">Database backup formats</a></li>
                <li>
                    <a href="#how-to-know-if-the-postgresql-backup-is-good" aria-label="How to know if the PostgreSQL backup is good?">How to know if the PostgreSQL backup is good?</a></li>
                <li>
                    <a href="#handling-large-databases" aria-label="Handling large databases">Handling large databases</a></li>
                <li>
                    <a href="#connected-to-gigadb-database-container" aria-label="Connected to gigadb database container">Connected to gigadb database container</a></li>
                <li>
                    <a href="#reference" aria-label="Reference">Reference</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="what-is-postgresql">What is PostgreSQL?<a hidden class="anchor" aria-hidden="true" href="#what-is-postgresql">#</a></h3>
<p><img alt="img" loading="lazy" src="/image/postgresql_logo.png"></p>
<blockquote>
<p>PostgreSQL is an enterprise-class open source database management system.
It supports both SQL for relational and JSON for non-relational queries.
PostgreSQL supports advanced data types and advance performance optimization.</p></blockquote>
<h3 id="key-features">Key features<a hidden class="anchor" aria-hidden="true" href="#key-features">#</a></h3>
<ul>
<li>Compatible with various platforms using all major languages and middleware</li>
<li>It offers a most sophisticated locking mechanism</li>
<li>Support for multi-version concurrency control</li>
<li>Compliant with the ANSI SQL standard</li>
<li>Full support for client-server network architecture</li>
<li>Log-based and trigger-based replication SSL</li>
<li>Standby server and high availability</li>
<li>Object-oriented and ANSI-SQL2008 compatible</li>
<li>Support for JSON allows linking with other data stores like NoSQL which act as a federated hub for polyglot databases</li>
</ul>
<h3 id="mysql-vs-postgresql">MySQL vs PostgreSQL<a hidden class="anchor" aria-hidden="true" href="#mysql-vs-postgresql">#</a></h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">MySQL</th>
          <th style="text-align: left">PostgreSQL</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">The MySQL project has made its source code available under the terms of the GNU License, and other proprietary agreements.</td>
          <td style="text-align: left">PostgreSQL is released under PostgreSQL License.</td>
      </tr>
      <tr>
          <td style="text-align: left">It&rsquo;s now owned by Oracle Corporation and offers several paid editions.</td>
          <td style="text-align: left">It&rsquo;s free and open-source software. That means you will never need to pay anything for this service.</td>
      </tr>
      <tr>
          <td style="text-align: left">MySQL is ACID compliant only when using with NDB and InnoDB Cluster Storage engines.</td>
          <td style="text-align: left">PostgreSQL is completely ACID compliant.</td>
      </tr>
      <tr>
          <td style="text-align: left">MySQL performs well in OLAP and OLTP systems where only read speed is important.</td>
          <td style="text-align: left">PostgreSQL performance works best in systems which demand the execution of complex queries.</td>
      </tr>
      <tr>
          <td style="text-align: left">MySQL is reliable and works well with BI (Business Intelligence) applications, which are difficult to read</td>
          <td style="text-align: left">PostgreSQL works well with BI applications. However, it is more suited for Data Warehousing and data analysis applications which need fast read-write speeds.</td>
      </tr>
  </tbody>
</table>
<h3 id="advantages">Advantages<a hidden class="anchor" aria-hidden="true" href="#advantages">#</a></h3>
<ol>
<li>Can run dynamic websites and web apps.</li>
<li>Write-ahead logging makes it a highly fault-tolerant database.</li>
<li>Source code is freely available under an open source license.</li>
<li>Supports geographic objects so you can use it for location-based services and geographic information systems.</li>
<li>Supports geographic objects so it can be used as a geospatial data store for location-based services and geographic information systems.</li>
<li>Low maintenance administration for both embedded and enterprise use.</li>
</ol>
<h3 id="disadvantages">Disadvantages<a hidden class="anchor" aria-hidden="true" href="#disadvantages">#</a></h3>
<ol>
<li>Changes made for speed improvement requires more work than MySQL as PostgreSQL focuses on compatibility.</li>
<li>Many open source apps support MySQL, but may not support PostgreSQL.</li>
<li>On performance metrics, it is slower than MySQL.</li>
</ol>
<h3 id="download-and-install">Download and install<a hidden class="anchor" aria-hidden="true" href="#download-and-install">#</a></h3>
<ol>
<li>Download and install <code>postgrlSQL</code><br>
<code>brew doctor</code><br>
<code>brew update</code><br>
<code>brew install postgresql</code></li>
<li>Download and install <code>Pgcli</code>, for <code>Postgres with auto-completion and syntax highlighting.</code><br>
<code>brew install pgcli</code></li>
<li>The path of <code>psql</code><br>
<code>brew info libpq</code></li>
<li>To include in in <code>zshrc</code><br>
<code>echo 'export PATH=&quot;/usr/local/opt/libpq/bin:$PATH&quot;' &gt;&gt; ~/.zshrc</code></li>
</ol>
<h3 id="postgreapp"><a href="https://postgresapp.com/downloads.html">Postgre.app</a><a hidden class="anchor" aria-hidden="true" href="#postgreapp">#</a></h3>
<p>Postgre.app is a full-featured PostgreSQL installation packaged as a standard Mac app.</p>
<h3 id="configure-the-path-for-cli-optional">Configure the $PATH for <a href="https://postgresapp.com/documentation/cli-tools.html">CLI</a> (Optional)<a hidden class="anchor" aria-hidden="true" href="#configure-the-path-for-cli-optional">#</a></h3>
<p><code>sudo mkdir -p /etc/paths.d &amp;&amp; echo /Applications/Postgres.app/Contents/Versions/latest/bin | sudo tee /etc/paths.d/postgresapp</code></p>
<h3 id="changing-the-default-directory-of-postgresql-optional"><a href="https://thecodinginterface.com/blog/postgresql-changing-data-directory/">Changing</a> the default directory of PostgreSQL (Optional)<a hidden class="anchor" aria-hidden="true" href="#changing-the-default-directory-of-postgresql-optional">#</a></h3>
<p><code>kencho=# SHOW data_directory;</code></p>
<blockquote>
<p>/Users/kencho/Library/Application Support/Postgres/var-12</p></blockquote>
<h3 id="datatypes">Datatypes<a hidden class="anchor" aria-hidden="true" href="#datatypes">#</a></h3>
<ol>
<li>Characters</li>
</ol>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">varchr(n)</td>
          <td style="text-align: left">Allows you to declare variable-length with a limit</td>
      </tr>
      <tr>
          <td style="text-align: left">char(n)</td>
          <td style="text-align: left">Fixed-length, blank padded</td>
      </tr>
      <tr>
          <td style="text-align: left">text</td>
          <td style="text-align: left">User can use this data type to declare a variable with unlimited length</td>
      </tr>
  </tbody>
</table>
<ol start="2">
<li>Numeric</li>
</ol>
<ul>
<li>Integers</li>
<li>Floating-pointing numbers</li>
</ul>
<ol start="3">
<li>Binary</li>
</ol>
<ul>
<li>Binary strings allow storing odds of value zero</li>
<li>Non- printable octets</li>
</ul>
<ol start="4">
<li>Network Address Type</li>
</ol>
<ul>
<li>cider: IPv4 and IPv6 networks</li>
<li>Inet: IPv4 and IPv5 host and networks</li>
<li>macaaddr: MAC addresses</li>
</ul>
<ol start="5">
<li>
<p>Text Search Type</p>
</li>
<li>
<p>Date/Time
PostgreSQL timestamp offers microsecond precision instead of second precision. Date and time input is accepted in various format, including traditional Postgres, ISO 8601. SQL-compatible etc.</p>
</li>
<li>
<p>Boolean</p>
</li>
</ol>
<ul>
<li>True, <code>1</code></li>
<li>False, <code>0</code></li>
<li>null</li>
</ul>
<ol start="8">
<li>
<p>Geometric</p>
</li>
<li>
<p>Enumerated<br>
Enumerated Data types in PostgreSQL is useful for representing rarely changing information such as country code or branch id.
The Enumerated data type is represented in a table with foreign keys to ensure data integrity. Here is the example code:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-postgresql" data-lang="postgresql"><span class="line"><span class="cl"><span class="o">#</span><span class="n">Hair</span> <span class="n">color</span> <span class="k">is</span> <span class="n">fairly</span> <span class="n">static</span> <span class="k">in</span> <span class="n">a</span> <span class="n">demographic</span> <span class="k">database</span>
</span></span><span class="line"><span class="cl"><span class="k">CREATE</span> <span class="k">TYPE</span> <span class="n">hair_color</span> <span class="k">AS</span> <span class="k">ENUM</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;blond&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="10">
<li>
<p>Range</p>
</li>
<li>
<p>UUID
Universally Unique Identifies (UUID) is a 128-bit quantity, these identifiers are an ideal choice as it offers uniqueness within a single database.<br>
Example:<br>
<code>d5f28c97-b962-43be-9cf8-ca1632182e8e</code></p>
</li>
<li>
<p>XML
PostgreSQL allows you to store XML data in a data type, but it is nothing more than an extension to a text data type.<br>
But the advantage is that it checks that the input XML is well-formed.</p>
</li>
<li>
<p>Json</p>
</li>
</ol>
<ul>
<li>Json</li>
<li>Jsonb</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-postgresql" data-lang="postgresql"><span class="line"><span class="cl"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">employee</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">id</span> <span class="nb">integer</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">age</span>  <span class="nb">integer</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="k">data</span> <span class="nb">jsonb</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></div><ol start="14">
<li>Pseudo-types<br>
PostgreSQL has many special-purpose entries that are called pseudo-types.
You can&rsquo;t use pseudo-type as a column data type.
There are used to declare or function&rsquo;s argument or return type.<br>
Each of the available pseudo-types is helpful in situations where a function&rsquo;s behavior docs do not correspond to simply taking or returning a value of a specific SQL data type.</li>
</ol>
<h3 id="best-practice-using-data-types">Best practice using data types<a hidden class="anchor" aria-hidden="true" href="#best-practice-using-data-types">#</a></h3>
<ul>
<li>Use &ldquo;text&rdquo; data type unless you want to limit the input</li>
<li>Never use &ldquo;char.&rdquo;</li>
<li>Integers use &ldquo;int.&rdquo; Use bigint only when you have really big numbers</li>
<li>Use &ldquo;numeric&rdquo; almost always</li>
<li>Use float data type if you have IEEE 754 data source</li>
</ul>
<h3 id="exportsave-table-or-query">Export/save table or query<a hidden class="anchor" aria-hidden="true" href="#exportsave-table-or-query">#</a></h3>
<ol>
<li>Check current position<br>
<code>\! pwd</code></li>
<li>List folders<br>
<code>\! ls</code></li>
<li>Export the Full tables with header<br>
<code>COPY albums TO '/Users/dave/Downloads/albums.csv' DELIMITER ',' CSV HEADER;</code></li>
<li>Export the query to CSV with header<br>
<code>\copy [Table/Query] to [Relative Path] csv header</code></li>
</ol>
<h3 id="postgresql-backup">PostgreSQL backup<a hidden class="anchor" aria-hidden="true" href="#postgresql-backup">#</a></h3>
<ol>
<li>
<p>One-time single database backup <br>
<code>pg_dump</code> to back up a single database. It must be run as a user with read permissions to the database you intend to back up.
1.1 Log in as <code>postgre</code> user<br>
<code>su - postgres</code><br>
1.2 Dump the contents of a database to a file<br>
<code>pg_dump dbname &gt; dbname.bak</code><br>
1.3 Restore the database using <code>psql</code><br>
<code>psql newdb &lt; dbname.bak</code></p>
</li>
<li>
<p>Backup single database remotely<br>
<code>pg_dump -h 198.51.100.0 -p 5432 dbname &gt; dbname.bak</code></p>
</li>
<li>
<p>Backup all databases<br>
<code>pg_dump</code>only creates a backup of one database at a time, it does not store information about database roles or other cluster-wide configuration.
<code>pg_dumpall</code> can store information about database roles and other cluster-wide configuration.<br>
3.1 Create backup file
<code>pg_dumpall &gt; pg_backup.bak</code><br>
3.2 Restore all databases from the backup<br>
<code>psql -f pg_backup.bak psotgre</code></p>
</li>
</ol>
<h3 id="automate-backup-with-a-cron-task-say--backed-up-at-midnight-every-sunday">Automate backup with a cron task (say,  backed up at midnight every Sunday)<a hidden class="anchor" aria-hidden="true" href="#automate-backup-with-a-cron-task-say--backed-up-at-midnight-every-sunday">#</a></h3>
<ol>
<li>Log is as the <code>postgre</code> user<br>
<code>su - postgre</code></li>
<li>Create a directory to store the automatic backups
<code>mkdir -p /postgre/backups</code></li>
<li>Edit the crontab to create a cron task
<code>crontab -e</code></li>
<li>The cron task as
<code>0 0 * * 0 pg_dump -U postgres dbname &gt; ~/postgres/backups/dbname.bak &gt; /postgres/log/pg_dump.log</code></li>
</ol>
<h3 id="database-backup-formats">Database backup formats<a hidden class="anchor" aria-hidden="true" href="#database-backup-formats">#</a></h3>
<ul>
<li>*.bak: compressed binary format</li>
<li>*.sql: plaintext dump</li>
<li>*.tar: tarball</li>
</ul>
<h3 id="how-to-know-if-the-postgresql-backup-is-good">How to know if the PostgreSQL backup is good?<a hidden class="anchor" aria-hidden="true" href="#how-to-know-if-the-postgresql-backup-is-good">#</a></h3>
<p>A. Logical backup: The backup is stored in a human-readable format like SQL.<br>
B. Physical backup: The backup contains binary data.</p>
<ol>
<li>
<p>backup the database with logs
<code>pg_dumpall &gt; /path/to/dump.sql &gt; postgres/log/pg_dump.log</code></p>
</li>
<li>
<p>Then to verify the databse.bak is in the backup directory</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ grep <span class="s1">&#39;^[\]connect&#39;</span> /path/to/dump.sql <span class="p">|</span>awk <span class="s1">&#39;{print $2}&#39;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">template1
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">postgres
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">world
</span></span></code></pre></div><ol start="3">
<li>Finally, restore the backup and check manually, it is the most secure way to confirm</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># restore the backup</span>
</span></span><span class="line"><span class="cl">$ psql -f /path/to/dump.sql postgres
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># access it and check it</span>
</span></span><span class="line"><span class="cl">$ psql 
</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># \l</span>
</span></span></code></pre></div><h3 id="handling-large-databases">Handling large databases<a hidden class="anchor" aria-hidden="true" href="#handling-large-databases">#</a></h3>
<p>Some operating systems have maximum file size limits that cause problems when creating large pg_dump output files.
Fortunately, pg_dump can write to the standard output, so you can use standard Unix tools to work around this potential problem.</p>
<p>1.1 Use compressed dump<br>
<code>pg_dump dbname | gzip &gt; filename.gz</code><br>
1.2. Reload with<br>
<code>gunzip -c filename.gz | psql dbname</code>
or<br>
<code>cat filename.gz | gunzip | psql dbname</code></p>
<p>2.1 Use <code>splite</code>, split the output into smaller files that are acceptable in size to the underlying file system.<br>
<code>pg_dump dbname | split -b 1m - filename</code><br>
2.2 Reload with<br>
<code>cat filename* | psql dbname</code></p>
<h3 id="connected-to-gigadb-database-container">Connected to gigadb database container<a hidden class="anchor" aria-hidden="true" href="#connected-to-gigadb-database-container">#</a></h3>
<ol>
<li>Connect to gigadb database container locally<br>
<code>PGPASSWORD=vagrant psql -h localhost -p 54321 -U gigadb postgres</code></li>
<li>Create database<br>
<code>postgre=# CREATE DATADASE dbname;</code></li>
<li>Restore <code>dump</code> database<br>
<code>kencho % pg_restore -h localhost -p 54321 -U gigadb -d production_like --clean --no-owner -v sql/production_like.pgdmp</code></li>
</ol>
<h3 id="reference">Reference<a hidden class="anchor" aria-hidden="true" href="#reference">#</a></h3>
<ol>
<li><a href="https://www.guru99.com/introduction-postgresql.html">Introduction to PostgreSQL</a></li>
<li><a href="https://www.postgresql.org/download/">PostgreSQL download</a></li>
<li><a href="https://www.datacamp.com/community/tutorials/10-command-line-utilities-postgresql">10 Command-line Utilities in PostgreSQL</a></li>
<li><a href="https://gist.github.com/Kartones/dd3ff5ec5ea238d4c546">cheatsheet</a></li>
<li><a href="http://postgresguide.com/utilities/psql.html">Postgres Guide</a></li>
<li><a href="https://dataschool.com/learn-sql/how-to-export-data-to-csv-or-excel/">How to exort PostgreSQL Data to a CSV or Excel File</a></li>
<li><a href="https://www.linode.com/docs/databases/postgresql/how-to-back-up-your-postgresql-database/">PostgreSQL backup stratgy</a></li>
<li><a href="https://www.geeksforgeeks.org/crontab-in-linux-with-examples/">Cron task</a></li>
<li><a href="https://severalnines.com/database-blog/how-do-i-know-if-my-postgresql-backup-good">How Do I Know if My PostgreSQL Backup is Good?</a></li>
<li><a href="https://www.postgresql.org/docs/9.1/backup.html">Chapter 24. Backup and Restore</a></li>
<li><a href="https://pgdash.io/blog/testing-postgres-backups.html">Automated Testing of PostgreSQL Backups</a></li>
<li><a href="https://sqlzoo.net/">SQL Tutorial</a></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://gigathing.pages.dev/tags/postgresql/">PostgreSQL</a></li>
      <li><a href="https://gigathing.pages.dev/tags/sql/">SQL</a></li>
      <li><a href="https://gigathing.pages.dev/tags/database/">Database</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://gigathing.pages.dev/tdd/">
    <span class="title">« Prev</span>
    <br>
    <span>What is Tdd?</span>
  </a>
  <a class="next" href="https://gigathing.pages.dev/yiiforbeginners/">
    <span class="title">Next »</span>
    <br>
    <span>Yii1.1 for beginners</span>
  </a>
</nav>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "disqus_FHTaFcKzzy" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>kencho51</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
